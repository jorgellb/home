---
// Header Premium - Agencia de Dise침o Web
const navLinks = [
  { href: "/desarrollo-web", label: "Dise침o Web" },
  { href: "/audiovisual", label: "Audiovisual" },
  { href: "/marketing", label: "Marketing" },
  { href: "/diseno-grafico", label: "Dise침o Gr치fico" },
  { href: "/soporte", label: "Mantenimiento" },
];
---

<header class="fixed top-0 left-0 right-0 z-50 bg-white/80 backdrop-blur-xl border-b border-slate-100/80">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="flex items-center justify-between h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center group">
        <img 
          src="/imagenes/logo.png" 
          alt="Platanito Rico" 
          class="h-10 w-auto object-contain transition-transform duration-300 group-hover:scale-105"
          width="120"
          height="40"
        />
      </a>

      <!-- Desktop Navigation -->
      <nav class="hidden lg:flex items-center">
        {navLinks.map(link => (
          <a 
            href={link.href}
            class="relative px-5 py-2.5 text-sm font-medium text-slate-600 hover:text-orange-600 transition-all duration-300 group rounded-lg"
          >
            <!-- Background hover -->
            <span class="absolute inset-0 bg-orange-50 rounded-lg scale-0 group-hover:scale-100 transition-transform duration-300 ease-out"></span>
            <!-- Text -->
            <span class="relative z-10">{link.label}</span>
            <!-- Underline -->
            <span class="absolute bottom-1 left-1/2 -translate-x-1/2 w-0 h-0.5 bg-gradient-to-r from-orange-500 to-amber-500 rounded-full group-hover:w-1/2 transition-all duration-300"></span>
          </a>
        ))}
      </nav>

      <!-- CTA Button -->
      <div class="hidden lg:block">
        <a 
          href="/contacto"
          class="relative inline-flex items-center gap-2 px-6 py-2.5 bg-slate-900 text-white text-sm font-medium rounded-full overflow-hidden group hover:bg-orange-600 transition-colors duration-300"
        >
          <!-- Shine effect -->
          <span class="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -translate-x-full group-hover:translate-x-full transition-transform duration-700"></span>
          <span class="relative">Contactar</span>
          <svg class="w-4 h-4 relative group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
          </svg>
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button 
        id="menuBtn"
        class="lg:hidden relative w-11 h-11 flex flex-col items-center justify-center gap-1.5 rounded-xl border border-slate-200 hover:border-orange-300 hover:bg-orange-50 transition-colors duration-300 group"
        aria-label="Menu"
      >
        <span class="w-5 h-0.5 bg-slate-700 rounded-full origin-center group-hover:bg-orange-600 transition-colors duration-300"></span>
        <span class="w-5 h-0.5 bg-slate-700 rounded-full group-hover:bg-orange-600 transition-colors duration-300"></span>
        <span class="w-5 h-0.5 bg-slate-700 rounded-full origin-center group-hover:bg-orange-600 transition-colors duration-300"></span>
      </button>
    </div>
  </div>
</header>

<!-- Mobile Menu Overlay -->
<div id="mobileMenu" class="fixed inset-0 z-40 lg:hidden opacity-0 pointer-events-none">
  <!-- Backdrop with blur -->
  <div class="absolute inset-0 bg-slate-900/30 backdrop-blur-sm" id="menuBackdrop"></div>
  
  <!-- Menu Panel -->
  <div class="absolute top-24 left-4 right-4 bg-white rounded-3xl shadow-2xl shadow-slate-900/20 border border-slate-100 p-2 opacity-0" id="menuPanel">
    <nav class="flex flex-col p-4">
      {navLinks.map((link, i) => (
        <a 
          href={link.href}
          class="flex items-center justify-between px-5 py-4 text-slate-700 font-medium hover:text-orange-600 hover:bg-orange-50 rounded-2xl transition-colors duration-300 mobile-nav-link group"
        >
          <span class="text-base">{link.label}</span>
          <div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center group-hover:bg-orange-100 transition-colors">
            <svg class="w-4 h-4 text-slate-400 group-hover:text-orange-500 transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
            </svg>
          </div>
        </a>
      ))}
    </nav>
    
    <div class="p-4 pt-2">
      <a 
        href="/contacto"
        class="flex items-center justify-center gap-2 w-full px-6 py-4 bg-gradient-to-r from-orange-500 to-amber-500 text-white font-semibold rounded-2xl hover:shadow-lg hover:shadow-orange-500/30 transition-all duration-300 group"
      >
        <span>Contactar</span>
        <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"/>
        </svg>
      </a>
    </div>
  </div>
</div>

<style>
  /* Smooth hamburger animation handled by GSAP */
  #menuBtn span {
    will-change: transform, opacity;
  }
</style>

<script>
  import { gsap } from "gsap";

  const menuBtn = document.getElementById('menuBtn');
  const mobileMenu = document.getElementById('mobileMenu');
  const menuBackdrop = document.getElementById('menuBackdrop');
  const menuPanel = document.getElementById('menuPanel');
  const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');
  const hamburgerLines = menuBtn?.querySelectorAll('span');
  
  let isOpen = false;
  let isAnimating = false;

  // Set initial state
  gsap.set(mobileMenu, { pointerEvents: "none", opacity: 0 });
  gsap.set(menuBackdrop, { opacity: 0 });
  gsap.set(menuPanel, { y: -20, opacity: 0, scale: 0.95 });
  gsap.set(mobileNavLinks, { y: 10, opacity: 0 });

  const timeline = gsap.timeline({ paused: true, onComplete: () => { isAnimating = false; }, onReverseComplete: () => { isAnimating = false; } });

  // Build the timeline
  timeline
    .to(mobileMenu, { duration: 0.01, pointerEvents: "auto", opacity: 1 })
    .to(menuBackdrop, { duration: 0.3, opacity: 1, ease: "power2.out" })
    .to(menuPanel, { duration: 0.4, y: 0, opacity: 1, scale: 1, ease: "back.out(1.7)" }, "-=0.2")
    .to(mobileNavLinks, { duration: 0.3, y: 0, opacity: 1, stagger: 0.05, ease: "power2.out" }, "-=0.2");

  function toggleMenu() {
    if (isAnimating) return;
    isAnimating = true;
    isOpen = !isOpen;
    
    if (isOpen) {
      timeline.play();
      
      // Animate hamburger to X
      if (hamburgerLines) {
        gsap.to(hamburgerLines[0], { rotate: 45, y: 8, duration: 0.3 });
        gsap.to(hamburgerLines[1], { opacity: 0, scaleX: 0, duration: 0.2 });
        gsap.to(hamburgerLines[2], { rotate: -45, y: -8, duration: 0.3 });
      }
    } else {
      timeline.reverse();
      
      // Reset hamburger
      if (hamburgerLines) {
        gsap.to(hamburgerLines[0], { rotate: 0, y: 0, duration: 0.3 });
        gsap.to(hamburgerLines[1], { opacity: 1, scaleX: 1, duration: 0.3 });
        gsap.to(hamburgerLines[2], { rotate: 0, y: 0, duration: 0.3 });
      }
    }
  }
  
  menuBtn?.addEventListener('click', toggleMenu);
  menuBackdrop?.addEventListener('click', toggleMenu);
  
  mobileNavLinks.forEach(link => {
    link.addEventListener('click', toggleMenu);
  });
  
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && isOpen) toggleMenu();
  });
</script>
